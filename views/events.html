<!DOCTYPE html>

<!--
  GR4 - Trackr
  Czarina Lao, Veronica Lee, Jing Lin, Sam Song
-->
<html>

<head>
<meta charset="UTF-8">
<title>Trackr - Events</title>

<!-- Load style sheets -->
<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="./../css/mainLayout.css" />
<link rel="stylesheet" href="./../css/events.css" />
<link rel='stylesheet' href='./../fullcalendar-2.6.1/fullcalendar.css' />

</head>

<body>

<header class="header">
	<p style="float:left;"><a id="home" href="./index.html">Trackr</a></p>
	<div id="header-buttons">
		<ul class="header-button-list">
			<li class="dropdown">
				<a href="javascript:void(0)" class="dropbtn" id="event-button" onclick="dropdown('event-updates')">Event<br>Updates</a>
				<div class="dropdown-content" id="event-updates">
					<a href="#">Event 1</a>
					<a href="#">Event 2</a>
					<a href="#">Event 3</a>
				</div>
			</li>
			<li class="dropdown">
				<a href="javascript:void(0)" class="dropbtn" id="feedback-button" onclick="dropdown('feedback-updates')">Feedback<br>Updates</a>
				<div class="dropdown-content" id="feedback-updates">
					<a href="#">Feedback 1</a>
					<a href="#">Feedback 2</a>
					<a href="#">Feedback 3</a>
				</div>
			</li>
			<li class="dropdown">
				<a href="javascript:void(0)" class="dropbtn" id="triangle-button" onclick="dropdown('triangle-menu')">▼</a>
				<div class="dropdown-content" id="triangle-menu">
					<a href="#">Account</a>
					<a href="#">Settings</a>
					<a href="#">Log Out</a>
				</div>
			</li>
		</ul>
	</div>
</header>

<div id="content">
	<div id="calendar">
	</div>
	<div class="addEvent-dialog" id="addEvent-dialog-text">
		<form action="javascript:addEvent();" class="addEvent-form">
			<label for="name">Event Name: </label><input type="text" name="name" id="name" required/><br>
			<label for="startDate">Start Date: </label><input type="text" name="date" id="date" required/><br> 
			<label for="startTime">Start Time: </label><input type="time" name="startTime" id="textbox" required/><br>
			<label for="endDate">End Date: </label><input type="text" name="date" id="date"/><br>  
			<label for="endTime">End Time: </label><input type="time" name="endTime" id="endTime"/><br> 
			<label for="location">Location: </label><input type="text" name="location" id="location"/><br> 
			<label for="share">Share with: </label>
				<select name="teams" value:"Select Team/s">
					<option value="">Gymnastics</option>
					<option value="">Soccer</option>
					<option value="">Tennis</option>
				  <!-- <option value="">generate list of teams</option> -->
				</select><br>
			<label for="request">Request Feedback: </label><input type="checkbox" name="request" id="request"/><br> 
			<input type="submit" value="Save and Share"/>
		</form>
	</div>
</div>




<!-- Right Panel -->
<!-- <div id="right-panel">
	<div id="right-panel-button" class="open">
		<span id="right-panel-triangle">
	</div>
	<div id="player-list">
		<input type="text" id="search-bar" value="🔍 Search..."></input>
		
		<select required id="team-select">
			<option class="placeholder" selected disabled value="">Team:</option>
		</select>
		
		<ul id="team-members">

		</ul>
	</div>
</div> -->

<script type="text/javascript" src="./../external_js/jquery-1.9.0.min.js"></script>
<link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
<script type="text/javascript" src="./../js/header.js"></script>
<script src='./../fullcalendar-2.6.1/lib/moment.min.js'></script>
<script src='./../fullcalendar-2.6.1/fullcalendar.js'></script>
<script type='text/javascript' src='./../fullcalendar-2.6.1/gcal.js'></script>

<script type="text/javascript">

		$( "#startTime" ).bind('change keyup input',function() {
  alert( "Handler for .change() called." );
});
	$(document).ready(function() {
		$("#textbox").keyup(function() {alert("Keyup detected!");});
$("#textbox").change(function() {alert("Change detected!");});
$("#textbox").bind('paste',function() {alert("paste detected!");});

		$('#startTime').on('input propertychange paste', function() {
			console.log('here');
	        if ($('#endTime').val() === '') {
	        	console.log('h');
	        	$('#endTime').val($('#startTime').val());
	        }
	    });

	    $('#calendar').fullCalendar({
	    	timezone: "local",
	    	fixedWeekCount: false, // makes calendar just display the weeks in that month

	        header:  {
	        	left: 'prev,next today',
	        	center: 'title',
	        	right: 'addEvent month,agendaWeek,agendaDay'
	        },

	        eventClick: function(event) {
	        	if (event.url) return false; // don't allow redirection to source website of events
	        	// TODO: call eventClick function here to show summary of event details and to edit the event
	        },

	        dayClick: function(event) {
	        	// TODO: call function that brings out the week schedule?
	        },

	        selectable: true,
	        // selectHelper: true,
	        select: function(start, end) {
				var title = prompt('Event Title:');
				var eventData;
				if (title) {
					eventData = {
						title: title,
						start: start,
						end: end
					};
					$('#calendar').fullCalendar('renderEvent', eventData, false); // stick? = true
				}
				$('#calendar').fullCalendar('unselect');
			},

			editable: true, //for drag and drop
			eventLimit: true, //more link shows up when there are too many events

	        googleCalendarApiKey: 'AIzaSyCX_A2rKiGZ4wo6LXNyJZ7WCK64SSqVSqU',
            events: {
            	editable: true,
                googleCalendarId: '3qff5g4q570qkmhdo6546mpt5o@group.calendar.google.com', //6.813 class calendar
            },

            customButtons: {
            	addEvent: {
            		id: 'test',
	            	text: 'Add Event',
	            	click: function(e) {

						var top = $(this).position().top + $(this).outerHeight();
						var left = $(this).position().left;
						showAddEventPopover($(this));

						// $(document).on('mousedown', 'documentMousedown');

						var options = {
							className: 'addEvent-popover',
							content: '<div class="fc-header fc-widget-header"> <span class="fc-close fc-icon fc-icon-x"></span><span class="fc-title">Add Event</span><div class="fc-clear"></div>'
	    									+ '</div>'
	    									+ '<div class="fc-body fc-widget-content"><div class="fc-content">' + $(".addEvent-dialog").html() +'</div>'
	    									+ '</div>',
	    					top: top,
	    					left: left,
	    					autoHide: true

						}

    					return false;

		            }
		        }
            }
	        
	    });

	    $(".fc-addEvent-button").css({'background-color': '#990000', 'background-image': 'none', 'color': 'white'});
	    // $(".fc-addEvent-button").after('<div id="addEvent-popover" class="fc-popover">' +
	    // 									'<div class="fc-header fc-widget-header"> <span class="fc-close fc-icon fc-icon-x"></span><span class="fc-title">Add Event</span><div class="fc-clear"></div>'
	    // 									+ '</div>'
	    // 									+ '<div class="fc-body fc-widget-content"><div class="fc-content">' + $(".addEvent-dialog").html() +'</div>'
	    // 									+ '</div>'
	    // 								+ '</div>');
	    // $("#addEvent-popover").css({'color': 'black', 'z-index': '1000','display': 'none'});

	    $(function() {
			$( "#date" ).datepicker();
			
		});


	});

	function addEvent() {
		var date = $('#startDate').val();
		var startTime = $('#startTime').val();
		var startDateTime = new Date(date+' '+startTime);
		var endTime = $('#endTime').val();

		var event = {
			title: $('#name').val(),
			start: startDateTime.toISOString(),
		}
		$('#calendar').fullCalendar('renderEvent', event);
		$("#addEvent-popover").css({'display':'none'});
	}

	function showAddEventPopover(jQueryObj) {
		var id = jQueryObj.attr('id') + '-popover';
		jQueryObj.after('<div id="' + id + '" class="fc-popover">' +
	    					'<div class="fc-header fc-widget-header"> <span class="fc-close fc-icon fc-icon-x"></span><span class="fc-title">Add Event</span><div class="fc-clear"></div>'
	    					+ '</div>'
	    					+ '<div class="fc-body fc-widget-content"><div class="fc-content">' + $(".addEvent-dialog").html() +'</div>'
	    					+ '</div>'
	    				+ '</div>');
		var popover = $('#'+id);
		var top = jQueryObj.position().top + jQueryObj.outerHeight();

		popover.css({'display':'block', 'top':top, 'z-index':'1000'});
		popover.on('click', '.fc-close', function() {
			popover.css({'display':'none'});
			popover.remove();
		});
	}

	// function documentMousedown(e) {
	// 	if ($("#addEvent-popover") && !$(e.target).closest($("#addEvent-popover")).length) {
	// 		$("#addEvent-popover").css({'display':'none'});
	// 		$(document).off('mousedown', 'documentMousedown');

	// 	}
	// }

</script>

</body>

</html>